最基本的 TCP server 和 client 写法【观察 server 的打印】

当你先启动服务端：`go run base/1.basic/server/main.go`

然后再启动客户端时：`go run base/1.basic/client/main.go`

会发生以下事件：

1. **服务端启动与监听**
    服务端程序调用 `net.Listen("tcp", ":8888")` 后，开始在 8888 端口监听 TCP 连接。随后输出 “已启动 tcp server”，表示服务端正在等待连接请求。
2. **客户端发起连接**
    客户端调用 `net.Dial("tcp", ":8888")` 向服务端发起连接。如果连接成功，会输出 “dial ok”。此时，客户端与服务端之间建立了 TCP 连接。
3. **服务端接受连接**
    服务端在监听循环中调用 `l.Accept()` 接收到来自客户端的连接，并输出 “接受到一个新的连接”。随后，通过 `go handleConn(c)` 为该连接启动一个新的 goroutine 来处理读操作。
4. **服务端处理连接**
    在 `handleConn` 函数中，服务端首先打印 “准备读取...”，然后调用 `c.Read(buf)` 来尝试从客户端读取数据。
   * **没有发送数据的情况：**
      由于客户端代码仅仅建立连接后即打印 “dial ok” 并结束程序（通过 defer 调用关闭连接），客户端没有向服务端发送任何数据。因此，服务端的 `c.Read(buf)` 将处于等待数据状态。
   * **连接关闭与错误返回：**
      当客户端退出并关闭连接时，服务端的 `Read` 方法返回了一个错误，通常这个错误是 `io.EOF`，表示对端已关闭连接。服务端会打印出类似 “读取发生错误：EOF” 的信息，并退出 `handleConn` 函数（由于 defer 机制，会关闭该连接）。

![image-20250408113520727](http://images.liangning7.cn/typora/202504081135798.png)